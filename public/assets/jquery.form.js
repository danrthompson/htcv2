!function(e){e.fn.ajaxSubmit=function(t){function i(){function i(){if(!p++){c.detachEvent?c.detachEvent("onload",i):c.removeEventListener("load",i,!1);var t=!0;try{if(f)throw"timeout";var s,a;if(a=c.contentWindow?c.contentWindow.document:c.contentDocument?c.contentDocument:c.document,h.responseText=a.body?a.body.innerHTML:null,h.responseXML=a.XMLDocument?a.XMLDocument:a,h.getResponseHeader=function(e){var t={"content-type":r.dataType};return t[e]},"json"==r.dataType||"script"==r.dataType){var o=a.getElementsByTagName("textarea")[0];h.responseText=o?o.value:h.responseText}else"xml"!=r.dataType||h.responseXML||null==h.responseText||(h.responseXML=n(h.responseText));s=e.httpData(h,r.dataType)}catch(u){t=!1,e.handleError(r,h,"error",u)}t&&(r.success(s,"success"),d&&e.event.trigger("ajaxSuccess",[h,r])),d&&e.event.trigger("ajaxComplete",[h,r]),d&&!--e.active&&e.event.trigger("ajaxStop"),r.complete&&r.complete(h,t?"success":"error"),setTimeout(function(){l.remove(),h.responseXML=null},100)}}function n(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&"parsererror"!=t.documentElement.tagName?t:null}var s=o[0],r=e.extend({},e.ajaxSettings,t),a="jqFormIO"+(new Date).getTime(),l=e('<iframe id="'+a+'" name="'+a+'" />'),c=l[0],u=e.browser.opera&&window.opera.version()<9;(e.browser.msie||u)&&(c.src='javascript:false;document.write("");'),l.css({position:"absolute",top:"-1000px",left:"-1000px"});var h={responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){}},d=r.global;d&&!e.active++&&e.event.trigger("ajaxStart"),d&&e.event.trigger("ajaxSend",[h,r]);var p=0,f=0;setTimeout(function(){var n=o.attr("target"),u=o.attr("action");o.attr({target:a,encoding:"multipart/form-data",enctype:"multipart/form-data",method:"POST",action:r.url}),r.timeout&&setTimeout(function(){f=!0,i()},r.timeout);var h=[];try{if(t.extraData)for(var d in t.extraData)h.push(e('<input type="hidden" name="'+d+'" value="'+t.extraData[d]+'" />').appendTo(s)[0]);l.appendTo("body"),c.attachEvent?c.attachEvent("onload",i):c.addEventListener("load",i,!1),s.submit()}finally{o.attr("action",u),n?o.attr("target",n):o.removeAttr("target"),e(h).remove()}},10)}"function"==typeof t&&(t={success:t}),t=e.extend({url:this.attr("action")||window.location.toString(),type:this.attr("method")||"GET"},t||{});var n={};if(this.trigger("form-pre-serialize",[this,t,n]),n.veto)return this;var s=this.formToArray(t.semantic);if(t.data){t.extraData=t.data;for(var r in t.data)s.push({name:r,value:t.data[r]})}if(t.beforeSubmit&&t.beforeSubmit(s,this,t)===!1)return this;if(this.trigger("form-submit-validate",[s,this,t,n]),n.veto)return this;var a=e.param(s);"GET"==t.type.toUpperCase()?(t.url+=(t.url.indexOf("?")>=0?"&":"?")+a,t.data=null):t.data=a;var o=this,l=[];if(t.resetForm&&l.push(function(){o.resetForm()}),t.clearForm&&l.push(function(){o.clearForm()}),!t.dataType&&t.target){var c=t.success||function(){};l.push(function(i){e(t.target).html(i).each(c,arguments)})}else t.success&&l.push(t.success);t.success=function(e,t){for(var i=0,n=l.length;n>i;i++)l[i](e,t,o)};for(var u=e("input:file",this).fieldValue(),h=!1,d=0;d<u.length;d++)u[d]&&(h=!0);return t.iframe||h?e.browser.safari&&t.closeKeepAlive?e.get(t.closeKeepAlive,i):i():e.ajax(t),this.trigger("form-submit-notify",[this,t]),this},e.fn.ajaxForm=function(t){return this.ajaxFormUnbind().bind("submit.form-plugin",function(){return e(this).ajaxSubmit(t),!1}).each(function(){e(":submit,input:image",this).bind("click.form-plugin",function(t){var i=this.form;if(i.clk=this,"image"==this.type)if(void 0!=t.offsetX)i.clk_x=t.offsetX,i.clk_y=t.offsetY;else if("function"==typeof e.fn.offset){var n=e(this).offset();i.clk_x=t.pageX-n.left,i.clk_y=t.pageY-n.top}else i.clk_x=t.pageX-this.offsetLeft,i.clk_y=t.pageY-this.offsetTop;setTimeout(function(){i.clk=i.clk_x=i.clk_y=null},10)})})},e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin"),this.each(function(){e(":submit,input:image",this).unbind("click.form-plugin")})},e.fn.formToArray=function(t){var i=[];if(0==this.length)return i;var n=this[0],s=t?n.getElementsByTagName("*"):n.elements;if(!s)return i;for(var r=0,a=s.length;a>r;r++){var o=s[r],l=o.name;if(l)if(t&&n.clk&&"image"==o.type)o.disabled||n.clk!=o||i.push({name:l+".x",value:n.clk_x},{name:l+".y",value:n.clk_y});else{var c=e.fieldValue(o,!0);if(c&&c.constructor==Array)for(var u=0,h=c.length;h>u;u++)i.push({name:l,value:c[u]});else null!==c&&"undefined"!=typeof c&&i.push({name:l,value:c})}}if(!t&&n.clk)for(var d=n.getElementsByTagName("input"),r=0,a=d.length;a>r;r++){var p=d[r],l=p.name;l&&!p.disabled&&"image"==p.type&&n.clk==p&&i.push({name:l+".x",value:n.clk_x},{name:l+".y",value:n.clk_y})}return i},e.fn.formSerialize=function(t){return e.param(this.formToArray(t))},e.fn.fieldSerialize=function(t){var i=[];return this.each(function(){var n=this.name;if(n){var s=e.fieldValue(this,t);if(s&&s.constructor==Array)for(var r=0,a=s.length;a>r;r++)i.push({name:n,value:s[r]});else null!==s&&"undefined"!=typeof s&&i.push({name:this.name,value:s})}}),e.param(i)},e.fn.fieldValue=function(t){for(var i=[],n=0,s=this.length;s>n;n++){var r=this[n],a=e.fieldValue(r,t);null===a||"undefined"==typeof a||a.constructor==Array&&!a.length||(a.constructor==Array?e.merge(i,a):i.push(a))}return i},e.fieldValue=function(t,i){var n=t.name,s=t.type,r=t.tagName.toLowerCase();if("undefined"==typeof i&&(i=!0),i&&(!n||t.disabled||"reset"==s||"button"==s||("checkbox"==s||"radio"==s)&&!t.checked||("submit"==s||"image"==s)&&t.form&&t.form.clk!=t||"select"==r&&-1==t.selectedIndex))return null;if("select"==r){var a=t.selectedIndex;if(0>a)return null;for(var o=[],l=t.options,c="select-one"==s,u=c?a+1:l.length,h=c?a:0;u>h;h++){var d=l[h];if(d.selected){var p=e.browser.msie&&!d.attributes.value.specified?d.text:d.value;if(c)return p;o.push(p)}}return o}return t.value},e.fn.clearForm=function(){return this.each(function(){e("input,select,textarea",this).clearFields()})},e.fn.clearFields=e.fn.clearInputs=function(){return this.each(function(){var e=this.type,t=this.tagName.toLowerCase();"text"==e||"password"==e||"textarea"==t?this.value="":"checkbox"==e||"radio"==e?this.checked=!1:"select"==t&&(this.selectedIndex=-1)})},e.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},e.fn.enable=function(e){return void 0==e&&(e=!0),this.each(function(){this.disabled=!e})},e.fn.select=function(t){return void 0==t&&(t=!0),this.each(function(){var i=this.type;if("checkbox"==i||"radio"==i)this.checked=t;else if("option"==this.tagName.toLowerCase()){var n=e(this).parent("select");t&&n[0]&&"select-one"==n[0].type&&n.find("option").select(!1),this.selected=t}})}}(jQuery);