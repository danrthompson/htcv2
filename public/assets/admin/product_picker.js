$.fn.productAutocomplete=function(){this.select2({minimumInputLength:1,multiple:!0,initSelection:function(e,t){$.get(Spree.routes.product_search,{ids:e.val().split(",")},function(e){t(e.products)})},ajax:{url:Spree.routes.product_search,datatype:"json",data:function(e){return{q:{name_cont:e,sku_cont:e},m:"OR"}},results:function(e){return{results:e.products}}},formatResult:function(e){return e.name},formatSelection:function(e){return e.name}})},$(document).ready(function(){$(".product_picker").productAutocomplete()});