$(document).ready(function(){var e=$("form.formtastic");if(e.length>0&&e.attr("id").match(/^(new_post|edit_post|new_page|edit_page)/)){var t=window.location.href;t=t.replace(/\/(new|\d+)$/,""),t+="/preview";var i=function(){0==$("#preview").length?(e.hide(),e.after('<div id="preview"><h3>Your entry will be formatted like this:</h3><p>Use Ctrl+E to return to edit mode.</p><div class="content"><p>Please wait...</p></div></div>'),jQuery.ajax({type:"POST",data:e.serialize().replace(/&*_method=\w+&*/,""),url:t,dataType:"html",error:function(){$("#preview .content").html("<p>Failed to generate preview. Toggle back to edit mode and check that all required fields are filled in and valid.</p>")},success:function(e){$("#preview .content").html(e)}})):($("#preview").remove(),e.show())};$(document).keyup(function(e){e.ctrlKey&&69==e.which&&(i(),e.preventDefault())})}});