/*
 Copyright 2012 Igor Vaynberg

 Version: 3.2 Timestamp: Mon Sep 10 10:38:04 PDT 2012

 Licensed under the Apache License, Version 2.0 (the "License"); you may not use this work except in
 compliance with the License. You may obtain a copy of the License in the LICENSE file, or at:

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software distributed under the License is
 distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and limitations under the License.
 */
!function(e){"undefined"==typeof e.fn.each2&&e.fn.extend({each2:function(t){for(var i=e([0]),n=-1,s=this.length;++n<s&&(i.context=i[0]=this[n])&&t.call(i[0],n,i)!==!1;);return this}})}(jQuery),function(e,t){"use strict";function i(e,t){var i,n=0,s=t.length;if("undefined"==typeof e)return-1;if(e.constructor===String){for(;s>n;n+=1)if(0===e.localeCompare(t[n]))return n}else for(;s>n;n+=1)if(i=t[n],i.constructor===String){if(0===i.localeCompare(e))return n}else if(i===e)return n;return-1}function n(e,i){return e===i?!0:e===t||i===t?!1:null===e||null===i?!1:e.constructor===String?0===e.localeCompare(i):i.constructor===String?0===i.localeCompare(e):!1}function s(t,i){var n,s,a;if(null===t||t.length<1)return[];for(n=t.split(i),s=0,a=n.length;a>s;s+=1)n[s]=e.trim(n[s]);return n}function a(e){return e.outerWidth()-e.width()}function r(i){var n="keyup-change-value";i.bind("keydown",function(){e.data(i,n)===t&&e.data(i,n,i.val())}),i.bind("keyup",function(){var s=e.data(i,n);s!==t&&i.val()!==s&&(e.removeData(i,n),i.trigger("keyup-change"))})}function o(i){i.bind("mousemove",function(i){var n=e.data(document,"select2-lastpos");(n===t||n.x!==i.pageX||n.y!==i.pageY)&&e(i.target).trigger("mousemove-filtered",i)})}function l(e,i,n){n=n||t;var s;return function(){var t=arguments;window.clearTimeout(s),s=window.setTimeout(function(){i.apply(n,t)},e)}}function c(e){var t,i=!1;return function(){return i===!1&&(t=e(),i=!0),t}}function h(e,t){var n=l(e,function(e){t.trigger("scroll-debounced",e)});t.bind("scroll",function(e){i(e.target,t.get())>=0&&n(e)})}function u(e){e.preventDefault(),e.stopPropagation()}function d(t){if(!T){var i=t[0].currentStyle||window.getComputedStyle(t[0],null);T=e("<div></div>").css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:i.fontSize,fontFamily:i.fontFamily,fontStyle:i.fontStyle,fontWeight:i.fontWeight,letterSpacing:i.letterSpacing,textTransform:i.textTransform,whiteSpace:"nowrap"}),e("body").append(T)}return T.text(t.val()),T.width()}function p(e,t,i){var n=e.toUpperCase().indexOf(t.toUpperCase()),s=t.length;return 0>n?(i.push(e),void 0):(i.push(e.substring(0,n)),i.push("<span class='select2-match'>"),i.push(e.substring(n,n+s)),i.push("</span>"),i.push(e.substring(n+s,e.length)),void 0)}function f(t){var i,n=0,s=null,a=t.quietMillis||100;return function(r){window.clearTimeout(i),i=window.setTimeout(function(){n+=1;var i=n,a=t.data,o=t.transport||e.ajax,l=t.traditional||!1,c=t.type||"GET";a=a.call(this,r.term,r.page,r.context),null!==s&&s.abort(),s=o.call(null,{url:t.url,dataType:t.dataType,data:a,type:c,traditional:l,success:function(e){if(!(n>i)){var s=t.results(e,r.page);r.callback(s)}}})},a)}}function g(t){var i,n=t,s=function(e){return""+e.text};return e.isArray(n)||(s=n.text,e.isFunction(s)||(i=n.text,s=function(e){return e[i]}),n=n.results),function(t){var i,a=t.term,r={results:[]};return""===a?(t.callback({results:n}),void 0):(i=function(n,r){var o,l;if(n=n[0],n.children){o={};for(l in n)n.hasOwnProperty(l)&&(o[l]=n[l]);o.children=[],e(n.children).each2(function(e,t){i(t,o.children)}),o.children.length&&r.push(o)}else t.matcher(a,s(n))&&r.push(n)},e(n).each2(function(e,t){i(t,r.results)}),t.callback(r),void 0)}}function m(i){return e.isFunction(i)?i:function(n){var s=n.term,a={results:[]};e(i).each(function(){var e=this.text!==t,i=e?this.text:this;(""===s||n.matcher(s,i))&&a.results.push(e?this:{id:this,text:this})}),n.callback(a)}}function v(t){if(e.isFunction(t))return!0;if(!t)return!1;throw new Error("formatterName must be a function or a falsy value")}function _(t){return e.isFunction(t)?t():t}function y(t){var i=0;return e.each(t,function(e,t){t.children?i+=y(t.children):i++}),i}function b(e,i,s,a){var r,o,l,c,h,u=e,d=!1;if(!a.createSearchChoice||!a.tokenSeparators||a.tokenSeparators.length<1)return t;for(;;){for(o=-1,l=0,c=a.tokenSeparators.length;c>l&&(h=a.tokenSeparators[l],o=e.indexOf(h),!(o>=0));l++);if(0>o)break;if(r=e.substring(0,o),e=e.substring(o+h.length),r.length>0&&(r=a.createSearchChoice(r,i),r!==t&&null!==r&&a.id(r)!==t&&null!==a.id(r))){for(d=!1,l=0,c=i.length;c>l;l++)if(n(a.id(r),a.id(i[l]))){d=!0;break}d||s(r)}}return 0!=u.localeCompare(e)?e:void 0}function x(t,i){var n=function(){};return n.prototype=new t,n.prototype.constructor=n,n.prototype.parent=t.prototype,n.prototype=e.extend(n.prototype,i),n}if(window.Select2===t){var w,k,j,C,S,T;w={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case w.LEFT:case w.RIGHT:case w.UP:case w.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case w.SHIFT:case w.CTRL:case w.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&123>=e}},S=function(){var e=1;return function(){return e++}}(),e(document).delegate("body","mousemove",function(t){e.data(document,"select2-lastpos",{x:t.pageX,y:t.pageY})}),e(document).ready(function(){e(document).delegate("body","mousedown touchend",function(i){var n,s=e(i.target).closest("div.select2-container").get(0);s?e(document).find("div.select2-container-active").each(function(){this!==s&&e(this).data("select2").blur()}):(s=e(i.target).closest("div.select2-drop").get(0),e(document).find("div.select2-drop-active").each(function(){this!==s&&e(this).data("select2").blur()})),s=e(i.target),n=s.attr("for"),"LABEL"===i.target.tagName&&n&&n.length>0&&(s=e("#"+n),s=s.data("select2"),s!==t&&(s.focus(),i.preventDefault()))})}),k=x(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(i){var n,s,a=".select2-results";this.opts=i=this.prepareOpts(i),this.id=i.id,i.element.data("select2")!==t&&null!==i.element.data("select2")&&this.destroy(),this.enabled=!0,this.container=this.createContainer(),this.containerId="s2id_"+(i.element.attr("id")||"autogen"+S()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=c(function(){return i.element.closest("body")}),i.element.attr("class")!==t&&this.container.addClass(i.element.attr("class").replace(/validate\[[\S ]+] ?/,"")),this.container.css(_(i.containerCss)),this.container.addClass(_(i.containerCssClass)),this.opts.element.data("select2",this).hide().before(this.container),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),this.dropdown.addClass(_(i.dropdownCssClass)),this.dropdown.data("select2",this),this.results=n=this.container.find(a),this.search=s=this.container.find("input.select2-input"),s.attr("tabIndex",this.opts.element.attr("tabIndex")),this.resultsPage=0,this.context=null,this.initContainer(),this.initContainerWidth(),o(this.results),this.dropdown.delegate(a,"mousemove-filtered",this.bind(this.highlightUnderEvent)),h(80,this.results),this.dropdown.delegate(a,"scroll-debounced",this.bind(this.loadMoreIfNeeded)),e.fn.mousewheel&&n.mousewheel(function(e,t,i,s){var a=n.scrollTop();s>0&&0>=a-s?(n.scrollTop(0),u(e)):0>s&&n.get(0).scrollHeight-n.scrollTop()+s<=n.height()&&(n.scrollTop(n.get(0).scrollHeight-n.height()),u(e))}),r(s),s.bind("keyup-change",this.bind(this.updateResults)),s.bind("focus",function(){s.addClass("select2-focused")," "===s.val()&&s.val("")}),s.bind("blur",function(){s.removeClass("select2-focused")}),this.dropdown.delegate(a,"mouseup",this.bind(function(t){e(t.target).closest(".select2-result-selectable:not(.select2-disabled)").length>0?(this.highlightUnderEvent(t),this.selectHighlighted(t)):this.focusSearch(),u(t)})),this.dropdown.bind("click mouseup mousedown",function(e){e.stopPropagation()}),e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),(i.element.is(":disabled")||i.element.is("[readonly='readonly']"))&&this.disable()},destroy:function(){var e=this.opts.element.data("select2");e!==t&&(e.container.remove(),e.dropdown.remove(),e.opts.element.removeData("select2").unbind(".select2").show())},prepareOpts:function(i){var a,r,o,l;if(a=i.element,"select"===a.get(0).tagName.toLowerCase()&&(this.select=r=i.element),r&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in i)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),i=e.extend({},{populateResults:function(n,s,a){var r,o=this.opts.id,l=this;r=function(n,s,c){var h,u,d,p,f,g,m,v,_;for(h=0,u=n.length;u>h;h+=1)d=n[h],p=o(d)!==t,f=d.children&&d.children.length>0,g=e("<li></li>"),g.addClass("select2-results-dept-"+c),g.addClass("select2-result"),g.addClass(p?"select2-result-selectable":"select2-result-unselectable"),f&&g.addClass("select2-result-with-children"),g.addClass(l.opts.formatResultCssClass(d)),m=e("<div></div>"),m.addClass("select2-result-label"),_=i.formatResult(d,m,a),_!==t&&m.html(l.opts.escapeMarkup(_)),g.append(m),f&&(v=e("<ul></ul>"),v.addClass("select2-result-sub"),r(d.children,v,c+1),g.append(v)),g.data("select2-data",d),s.append(g)},r(s,n,0)}},e.fn.select2.defaults,i),"function"!=typeof i.id&&(o=i.id,i.id=function(e){return e[o]}),r?(i.query=this.bind(function(i){var n,s,r,o={results:[],more:!1},l=i.term;r=function(e,t){var n;e.is("option")?i.matcher(l,e.text(),e)&&t.push({id:e.attr("value"),text:e.text(),element:e.get(),css:e.attr("class")}):e.is("optgroup")&&(n={text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")},e.children().each2(function(e,t){r(t,n.children)}),n.children.length>0&&t.push(n))},n=a.children(),this.getPlaceholder()!==t&&n.length>0&&(s=n[0],""===e(s).text()&&(n=n.not(s))),n.each2(function(e,t){r(t,o.results)}),i.callback(o)}),i.id=function(e){return e.id},i.formatResultCssClass=function(e){return e.css}):"query"in i||("ajax"in i?(l=i.element.data("ajax-url"),l&&l.length>0&&(i.ajax.url=l),i.query=f(i.ajax)):"data"in i?i.query=g(i.data):"tags"in i&&(i.query=m(i.tags),i.createSearchChoice=function(e){return{id:e,text:e}},i.initSelection=function(t,a){var r=[];e(s(t.val(),i.separator)).each(function(){var t=this,s=this,a=i.tags;e.isFunction(a)&&(a=a()),e(a).each(function(){return n(this.id,t)?(s=this.text,!1):void 0}),r.push({id:t,text:s})}),a(r)})),"function"!=typeof i.query)throw"query function not defined for Select2 "+i.element.attr("id");return i},monitorSource:function(){this.opts.element.bind("change.select2",this.bind(function(){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()}))},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},enable:function(){this.enabled||(this.enabled=!0,this.container.removeClass("select2-container-disabled"))},disable:function(){this.enabled&&(this.close(),this.enabled=!1,this.container.addClass("select2-container-disabled"))},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t,i,n,s=this.container.offset(),a=this.container.outerHeight(),r=this.container.outerWidth(),o=this.dropdown.outerHeight(),l=e(window).scrollTop()+document.documentElement.clientHeight,c=s.top+a,h=s.left,u=l>=c+o,d=s.top-o>=this.body().scrollTop(),p=this.dropdown.hasClass("select2-drop-above");"static"!==this.body().css("position")&&(t=this.body().offset(),c-=t.top,h-=t.left),p?(i=!0,!d&&u&&(i=!1)):(i=!1,!u&&d&&(i=!0)),i?(c=s.top-o,this.container.addClass("select2-drop-above"),this.dropdown.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")),n=e.extend({top:c,left:h,width:r},_(this.opts.dropdownCss)),this.dropdown.css(n)},shouldOpen:function(){var t;return this.opened()?!1:(t=e.Event("open"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(window.setTimeout(this.bind(this.opening),1),!0):!1},opening:function(){var t=this.containerId,i=this.containerSelector,n="scroll."+t,s="resize."+t;this.container.parents().each(function(){e(this).bind(n,function(){var t=e(i);0==t.length&&e(this).unbind(n),t.select2("close")})}),e(window).bind(s,function(){var t=e(i);0==t.length&&e(window).unbind(s),t.select2("close")}),this.clearDropdownAlignmentPreference()," "===this.search.val()&&this.search.val(""),this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.updateResults(!0),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active"),this.ensureHighlightVisible(),this.focusSearch()},close:function(){if(this.opened()){var t=this;this.container.parents().each(function(){e(this).unbind("scroll."+t.containerId)}),e(window).unbind("resize."+this.containerId),this.clearDropdownAlignmentPreference(),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),this.clearSearch(),this.opts.element.trigger(e.Event("close"))}},clearSearch:function(){},ensureHighlightVisible:function(){var t,i,n,s,a,r,o,l=this.results;if(i=this.highlight(),!(0>i)){if(0==i)return l.scrollTop(0),void 0;t=l.find(".select2-result-selectable"),n=e(t[i]),s=n.offset().top+n.outerHeight(),i===t.length-1&&(o=l.find("li.select2-more-results"),o.length>0&&(s=o.offset().top+o.outerHeight())),a=l.offset().top+l.outerHeight(),s>a&&l.scrollTop(l.scrollTop()+(s-a)),r=n.offset().top-l.offset().top,0>r&&l.scrollTop(l.scrollTop()+r)}},moveHighlight:function(t){for(var i=this.results.find(".select2-result-selectable"),n=this.highlight();n>-1&&n<i.length;){n+=t;var s=e(i[n]);if(s.hasClass("select2-result-selectable")&&!s.hasClass("select2-disabled")){this.highlight(n);break}}},highlight:function(t){var n=this.results.find(".select2-result-selectable").not(".select2-disabled");return 0===arguments.length?i(n.filter(".select2-highlighted")[0],n.get()):(t>=n.length&&(t=n.length-1),0>t&&(t=0),n.removeClass("select2-highlighted"),e(n[t]).addClass("select2-highlighted"),this.ensureHighlightVisible(),void 0)},countSelectableResults:function(){return this.results.find(".select2-result-selectable").not(".select2-disabled").length},highlightUnderEvent:function(t){var i=e(t.target).closest(".select2-result-selectable");if(i.length>0&&!i.is(".select2-highlighted")){var n=this.results.find(".select2-result-selectable");this.highlight(n.index(i))}else 0==i.length&&this.results.find(".select2-highlighted").removeClass("select2-highlighted")},loadMoreIfNeeded:function(){var e,t=this.results,i=t.find("li.select2-more-results"),n=this.resultsPage+1,s=this,a=this.search.val(),r=this.context;0!==i.length&&(e=i.offset().top-t.offset().top-t.height(),0>=e&&(i.addClass("select2-active"),this.opts.query({term:a,page:n,context:r,matcher:this.opts.matcher,callback:this.bind(function(e){s.opened()&&(s.opts.populateResults.call(this,t,e.results,{term:a,page:n,context:r}),e.more===!0?(i.detach().appendTo(t).text(s.opts.formatLoadMore(n+1)),window.setTimeout(function(){s.loadMoreIfNeeded()},10)):i.remove(),s.positionDropdown(),s.resultsPage=n)})})))},tokenize:function(){},updateResults:function(i){function s(){c.scrollTop(0),l.removeClass("select2-active"),u.positionDropdown()}function a(e){c.html(u.opts.escapeMarkup(e)),s()}var r,o,l=this.search,c=this.results,h=this.opts,u=this;if(i===!0||this.showSearchInput!==!1&&this.opened()){if(l.addClass("select2-active"),h.maximumSelectionSize>=1&&(r=this.data(),e.isArray(r)&&r.length>=h.maximumSelectionSize&&v(h.formatSelectionTooBig,"formatSelectionTooBig")))return a("<li class='select2-selection-limit'>"+h.formatSelectionTooBig(h.maximumSelectionSize)+"</li>"),void 0;if(l.val().length<h.minimumInputLength&&v(h.formatInputTooShort,"formatInputTooShort"))return a("<li class='select2-no-results'>"+h.formatInputTooShort(l.val(),h.minimumInputLength)+"</li>"),void 0;a("<li class='select2-searching'>"+h.formatSearching()+"</li>"),o=this.tokenize(),o!=t&&null!=o&&l.val(o),this.resultsPage=1,h.query({term:l.val(),page:this.resultsPage,context:null,matcher:h.matcher,callback:this.bind(function(r){var o;if(this.opened()){if(this.context=r.context===t?null:r.context,this.opts.createSearchChoice&&""!==l.val()&&(o=this.opts.createSearchChoice.call(null,l.val(),r.results),o!==t&&null!==o&&u.id(o)!==t&&null!==u.id(o)&&0===e(r.results).filter(function(){return n(u.id(this),u.id(o))}).length&&r.results.unshift(o)),0===r.results.length&&v(h.formatNoMatches,"formatNoMatches"))return a("<li class='select2-no-results'>"+h.formatNoMatches(l.val())+"</li>"),void 0;c.empty(),u.opts.populateResults.call(this,c,r.results,{term:l.val(),page:this.resultsPage,context:null}),r.more===!0&&v(h.formatLoadMore,"formatLoadMore")&&(c.append("<li class='select2-more-results'>"+u.opts.escapeMarkup(h.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){u.loadMoreIfNeeded()},10)),this.postprocessResults(r,i),s()}})})}},cancel:function(){this.close()},blur:function(){this.close(),this.container.removeClass("select2-container-active"),this.dropdown.removeClass("select2-drop-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){this.search.show(),this.search.focus(),window.setTimeout(this.bind(function(){this.search.show(),this.search.focus(),this.search.val(this.search.val())}),10)},selectHighlighted:function(){var e=this.highlight(),t=this.results.find(".select2-highlighted").not(".select2-disabled"),i=t.closest(".select2-result-selectable").data("select2-data");i&&(t.addClass("select2-disabled"),this.highlight(e),this.onSelect(i))},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){function i(){var i,n,s,a,r;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth()?"auto":this.opts.element.outerWidth()+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(i=this.opts.element.attr("style"),i!==t)for(n=i.split(";"),a=0,r=n.length;r>a;a+=1)if(s=n[a].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/),null!==s&&s.length>=1)return s[1];return"resolve"===this.opts.width?(i=this.opts.element.css("width"),i.indexOf("%")>0?i:0===this.opts.element.outerWidth()?"auto":this.opts.element.outerWidth()+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}var n=i.call(this);null!==n&&this.container.attr("style","width: "+n)}}),j=x(k,{createContainer:function(){var t=e("<div></div>",{"class":"select2-container"}).html(["    <a href='#' onclick='return false;' class='select2-choice'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","    <div class='select2-drop select2-offscreen'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},opening:function(){this.search.show(),this.parent.opening.apply(this,arguments),this.dropdown.removeClass("select2-offscreen")},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.dropdown.removeAttr("style").addClass("select2-offscreen").insertAfter(this.selection).show())},focus:function(){this.close(),this.selection.focus()},isFocused:function(){return this.selection[0]===document.activeElement},cancel:function(){this.parent.cancel.apply(this,arguments),this.selection.focus()},initContainer:function(){var e,t=this.container,i=this.dropdown,n=!1;this.selection=e=t.find(".select2-choice"),this.search.bind("keydown",this.bind(function(e){if(this.enabled){if(e.which===w.PAGE_UP||e.which===w.PAGE_DOWN)return u(e),void 0;if(this.opened())switch(e.which){case w.UP:case w.DOWN:return this.moveHighlight(e.which===w.UP?-1:1),u(e),void 0;case w.TAB:case w.ENTER:return this.selectHighlighted(),u(e),void 0;case w.ESC:return this.cancel(e),u(e),void 0}else{if(e.which===w.TAB||w.isControl(e)||w.isFunctionKey(e)||e.which===w.ESC)return;if(this.opts.openOnEnter===!1&&e.which===w.ENTER)return;if(this.open(),e.which===w.ENTER)return}}})),this.search.bind("focus",this.bind(function(){this.selection.attr("tabIndex","-1")})),this.search.bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active"),window.setTimeout(this.bind(function(){this.selection.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)})),e.bind("mousedown",this.bind(function(){n=!0,this.opened()?(this.close(),this.selection.focus()):this.enabled&&this.open(),n=!1})),i.bind("mousedown",this.bind(function(){this.search.focus()})),e.bind("focus",this.bind(function(){this.container.addClass("select2-container-active"),this.search.attr("tabIndex","-1")})),e.bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active"),window.setTimeout(this.bind(function(){this.search.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)})),e.bind("keydown",this.bind(function(e){if(this.enabled){if(e.which===w.PAGE_UP||e.which===w.PAGE_DOWN)return u(e),void 0;if(!(e.which===w.TAB||w.isControl(e)||w.isFunctionKey(e)||e.which===w.ESC||this.opts.openOnEnter===!1&&e.which===w.ENTER)){if(e.which==w.DELETE)return this.opts.allowClear&&this.clear(),void 0;if(this.open(),e.which===w.ENTER)return u(e),void 0;if(e.which<48)return u(e),void 0;var t=String.fromCharCode(e.which).toLowerCase();e.shiftKey&&(t=t.toUpperCase()),this.search.focus(),this.search.val(t),u(e)}}})),e.delegate("abbr","mousedown",this.bind(function(e){this.enabled&&(this.clear(),u(e),this.close(),this.triggerChange(),this.selection.focus())})),this.setPlaceholder(),this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")}))},clear:function(){this.opts.element.val(""),this.selection.find("span").empty(),this.selection.removeData("select2-data"),this.setPlaceholder()},initSelection:function(){if(""===this.opts.element.val())this.close(),this.setPlaceholder();else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(i){i!==t&&null!==i&&(e.updateSelection(i),e.close(),e.setPlaceholder())})}},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return"select"===t.element.get(0).tagName.toLowerCase()&&(t.initSelection=function(t,i){var n=t.find(":selected");e.isFunction(i)&&i({id:n.attr("value"),text:n.text()})}),t},setPlaceholder:function(){var e=this.getPlaceholder();if(""===this.opts.element.val()&&e!==t){if(this.select&&""!==this.select.find("option:first").text())return;this.selection.find("span").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.selection.find("abbr").hide()}},postprocessResults:function(t,i){var s=0,a=this,r=!0;this.results.find(".select2-result-selectable").each2(function(e,t){return n(a.id(t.data("select2-data")),a.opts.element.val())?(s=e,!1):void 0}),this.highlight(s),i===!0&&(r=this.showSearchInput=y(t.results)>=this.opts.minimumResultsForSearch,this.dropdown.find(".select2-search")[r?"removeClass":"addClass"]("select2-search-hidden"),e(this.dropdown,this.container)[r?"addClass":"removeClass"]("select2-with-searchbox"))},onSelect:function(e){var t=this.opts.element.val();this.opts.element.val(this.id(e)),this.updateSelection(e),this.close(),this.selection.focus(),n(t,this.id(e))||this.triggerChange()},updateSelection:function(e){var i,n=this.selection.find("span");this.selection.data("select2-data",e),n.empty(),i=this.opts.formatSelection(e,n),i!==t&&n.append(this.opts.escapeMarkup(i)),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.selection.find("abbr").show()},val:function(){var e,i=null,n=this;if(0===arguments.length)return this.opts.element.val();if(e=arguments[0],this.select)this.select.val(e).find(":selected").each2(function(e,t){return i={id:t.attr("value"),text:t.text()},!1}),this.updateSelection(i),this.setPlaceholder();else{if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");if(!e)return this.clear(),void 0;this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){n.opts.element.val(e?n.id(e):""),n.updateSelection(e),n.setPlaceholder()})}},clearSearch:function(){this.search.val("")},data:function(e){var i;return 0===arguments.length?(i=this.selection.data("select2-data"),i==t&&(i=null),i):(e&&""!==e?(this.opts.element.val(e?this.id(e):""),this.updateSelection(e)):this.clear(),void 0)}}),C=x(k,{createContainer:function(){var t=e("<div></div>",{"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return"select"===t.element.get(0).tagName.toLowerCase()&&(t.initSelection=function(t,i){var n=[];t.find(":selected").each2(function(e,t){n.push({id:t.attr("value"),text:t.text()})}),e.isFunction(i)&&i(n)}),t},initContainer:function(){var t,i=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=t=this.container.find(i),this.search.bind("keydown",this.bind(function(e){if(this.enabled){if(e.which===w.BACKSPACE&&""===this.search.val()){this.close();var i,n=t.find(".select2-search-choice-focus");if(n.length>0)return this.unselect(n.first()),this.search.width(10),u(e),void 0;i=t.find(".select2-search-choice"),i.length>0&&i.last().addClass("select2-search-choice-focus")}else t.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");if(this.opened())switch(e.which){case w.UP:case w.DOWN:return this.moveHighlight(e.which===w.UP?-1:1),u(e),void 0;case w.ENTER:case w.TAB:return this.selectHighlighted(),u(e),void 0;case w.ESC:return this.cancel(e),u(e),void 0}e.which===w.TAB||w.isControl(e)||w.isFunctionKey(e)||e.which===w.BACKSPACE||e.which===w.ESC||(this.opts.openOnEnter!==!1||e.which!==w.ENTER)&&(this.open(),(e.which===w.PAGE_UP||e.which===w.PAGE_DOWN)&&u(e))}})),this.search.bind("keyup",this.bind(this.resizeSearch)),this.search.bind("blur",this.bind(function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.clearSearch(),e.stopImmediatePropagation()})),this.container.delegate(i,"mousedown",this.bind(function(t){this.enabled&&(e(t.target).closest(".select2-search-choice").length>0||(this.clearPlaceholder(),this.open(),this.focusSearch(),t.preventDefault()))})),this.container.delegate(i,"focus",this.bind(function(){this.enabled&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.clearSearch()},enable:function(){this.enabled||(this.parent.enable.apply(this,arguments),this.search.removeAttr("disabled"))},disable:function(){this.enabled&&(this.parent.disable.apply(this,arguments),this.search.attr("disabled",!0))},initSelection:function(){if(""===this.opts.element.val()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var e=this;this.opts.initSelection.call(null,this.opts.element,function(i){i!==t&&null!==i&&(e.updateSelection(i),e.close(),e.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder();e!==t&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.resizeSearch()):this.search.val(" ").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")?this.search.val("").removeClass("select2-default"):" "===this.search.val()&&this.search.val("")},opening:function(){this.parent.opening.apply(this,arguments),this.clearPlaceholder(),this.resizeSearch(),this.focusSearch()},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var n=[],s=[],a=this;e(t).each(function(){i(a.id(this),n)<0&&(n.push(a.id(this)),s.push(this))}),t=s,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){a.addSelectedChoice(this)}),a.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer(e,this.data(),this.bind(this.onSelect),this.opts),null!=e&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e){this.addSelectedChoice(e),this.select&&this.postprocessResults(),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.positionDropdown()):this.close(),this.triggerChange({added:e}),this.focusSearch()},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(t){var i,n=e("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),s=this.id(t),a=this.getVal();i=this.opts.formatSelection(t,n),n.find("div").replaceWith("<div>"+this.opts.escapeMarkup(i)+"</div>"),n.find(".select2-search-choice-close").bind("mousedown",u).bind("click dblclick",this.bind(function(t){this.enabled&&(e(t.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),u(t))})).bind("focus",this.bind(function(){this.enabled&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),n.data("select2-data",t),n.insertBefore(this.searchContainer),a.push(s),this.setVal(a)},unselect:function(e){var t,n,s=this.getVal();if(e=e.closest(".select2-search-choice"),0===e.length)throw"Invalid argument: "+e+". Must be .select2-search-choice";t=e.data("select2-data"),n=i(this.id(t),s),n>=0&&(s.splice(n,1),this.setVal(s),this.select&&this.postprocessResults()),e.remove(),this.triggerChange({removed:t})},postprocessResults:function(){var e=this.getVal(),t=this.results.find(".select2-result-selectable"),n=this.results.find(".select2-result-with-children"),s=this;t.each2(function(t,n){var a=s.id(n.data("select2-data"));i(a,e)>=0?n.addClass("select2-disabled").removeClass("select2-result-selectable"):n.removeClass("select2-disabled").addClass("select2-result-selectable")}),n.each2(function(e,t){0==t.find(".select2-result-selectable").length?t.addClass("select2-disabled"):t.removeClass("select2-disabled")}),t.each2(function(e,t){return!t.hasClass("select2-disabled")&&t.hasClass("select2-result-selectable")?(s.highlight(0),!1):void 0})},resizeSearch:function(){var e,t,i,n,s,r=a(this.search);e=d(this.search)+10,t=this.search.offset().left,i=this.selection.width(),n=this.selection.offset().left,s=i-(t-n)-r,e>s&&(s=i-r),40>s&&(s=i-r),this.search.width(s)},getVal:function(){var e;return this.select?(e=this.select.val(),null===e?[]:e):(e=this.opts.element.val(),s(e,this.opts.separator))},setVal:function(t){var n;this.select?this.select.val(t):(n=[],e(t).each(function(){i(this,n)<0&&n.push(this)}),this.opts.element.val(0===n.length?"":n.join(this.opts.separator)))},val:function(){var i,n=[],s=this;if(0===arguments.length)return this.getVal();if(i=arguments[0],!i)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void 0;if(this.setVal(i),this.select)this.select.find(":selected").each(function(){n.push({id:e(this).attr("value"),text:e(this).text()})}),this.updateSelection(n);else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var i=e(t).map(s.id);s.setVal(i),s.updateSelection(t),s.clearSearch()})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");
this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],i=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(i.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t){var i,n=this;return 0===arguments.length?this.selection.find(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get():(t||(t=[]),i=e.map(t,function(e){return n.opts.id(e)}),this.setVal(i),this.updateSelection(t),this.clearSearch(),void 0)}}),e.fn.select2=function(){var n,s,a,r,o=Array.prototype.slice.call(arguments,0),l=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];return this.each(function(){if(0===o.length||"object"==typeof o[0])n=0===o.length?{}:e.extend({},o[0]),n.element=e(this),"select"===n.element.get(0).tagName.toLowerCase()?r=n.element.attr("multiple"):(r=n.multiple||!1,"tags"in n&&(n.multiple=r=!0)),s=r?new C:new j,s.init(n);else{if("string"!=typeof o[0])throw"Invalid arguments to select2 plugin: "+o;if(i(o[0],l)<0)throw"Unknown method: "+o[0];if(a=t,s=e(this).data("select2"),s===t)return;if(a="container"===o[0]?s.container:s[o[0]].apply(s,o.slice(1)),a!==t)return!1}}),a===t?this:a},e.fn.select2.defaults={width:"copy",closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,i){var n=[];return p(e.text,i.term,n),n.join("")},formatSelection:function(e){return e?e.text:t},formatResultCssClass:function(){return t},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){return"Please enter "+(t-e.length)+" more characters"},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(e,t){return t.toUpperCase().indexOf(e.toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:b,escapeMarkup:function(e){return e&&"string"==typeof e?e.replace(/&/g,"&amp;"):e},blurOnChange:!1},window.Select2={query:{ajax:f,local:g,tags:m},util:{debounce:l,markMatch:p},"class":{"abstract":k,single:j,multi:C}}}}(jQuery);